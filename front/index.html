<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MediaPipe Landmarks Detector</title>
    <link rel="stylesheet" href="/static/styles.css">
    <!-- MediaPipe: intentar cargar desde /vendor/mediapipe (si se descargaron localmente), si falla usar CDN -->
    <script>
    (function(){
        const files = [
            { local: '/static/vendor/mediapipe/camera_utils.js', cdn: 'https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js' },
            { local: '/static/vendor/mediapipe/drawing_utils.js', cdn: 'https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js' },
            { local: '/static/vendor/mediapipe/hands.js', cdn: 'https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js' }
        ];

        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const s = document.createElement('script');
                s.src = src;
                s.async = false;
                s.onload = () => resolve(src);
                s.onerror = () => reject(src);
                document.head.appendChild(s);
            });
        }

        // Cargar secuencialmente: intentar local, si falla usar CDN
        (async function() {
            for (const f of files) {
                try {
                    await loadScript(f.local);
                    // si se cargó localmente, continuar con el siguiente
                } catch (e) {
                    // fallback a CDN
                    try {
                        await loadScript(f.cdn);
                    } catch (ce) {
                        console.error('No se pudo cargar', f.local, 'ni', f.cdn);
                    }
                }
            }
        })();
    })();
    </script>
</head>
<body>
    <div class="container">
        <h1>Detector de Landmarks</h1>
        <div id="status" class="status loading">
            <span class="dot"></span>
            <span class="status-text">Cargando librerías...</span>
        </div>
        <div class="video-container">
            <video id="video" autoplay playsinline width="640" height="480"></video>
            <canvas id="overlay" width="640" height="480"></canvas>
        </div>
        <button id="send">Enviar landmarks</button>
    </div>
    <script src="/static/app.js"></script>
</body>
</html>
